From aebc2a785dbaaeb3f6728c738c3dc9b6ec6a2337 Mon Sep 17 00:00:00 2001
From: Jadon Fowler <jadonflower@gmail.com>
Date: Tue, 10 Oct 2017 15:13:52 -0400
Subject: [PATCH] Toggleable Elytra Wall Damage

Instead of calculating the damage taken from hitting a wall, you can
disable it in the config.

diff --git a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
index 94eb221..cc5548f 100644
--- a/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
+++ b/src/main/java/com/destroystokyo/paper/PaperWorldConfig.java
@@ -357,4 +357,9 @@ public class PaperWorldConfig {
             delayChunkUnloadsBy *= 1000;
         }
     }
+
+    public boolean elytraHitWallDamage = true;
+    private void elytraHitWallDamage() {
+        elytraHitWallDamage = getBoolean("elytra-hit-wall-damage", true);
+    }
 }
diff --git a/src/main/java/net/minecraft/entity/EntityLivingBase.java b/src/main/java/net/minecraft/entity/EntityLivingBase.java
index 83b5780..2ddf22d 100644
--- a/src/main/java/net/minecraft/entity/EntityLivingBase.java
+++ b/src/main/java/net/minecraft/entity/EntityLivingBase.java
@@ -1735,6 +1735,7 @@ public abstract class EntityLivingBase extends Entity {
             if (!this.isInWater() || this instanceof EntityPlayer && ((EntityPlayer) this).capabilities.isFlying) {
                 if (!this.isInLava() || this instanceof EntityPlayer && ((EntityPlayer) this).capabilities.isFlying) {
                     if (this.isElytraFlying()) {
+                        if (world.paperConfig.elytraHitWallDamage) { // Paper start - Toggleable Elytra Wall Damage
                         if (this.motionY > -0.5D) {
                             this.fallDistance = 1.0F;
                         }
@@ -1782,6 +1783,7 @@ public abstract class EntityLivingBase extends Entity {
                                 this.attackEntityFrom(DamageSource.FLY_INTO_WALL, f8);
                             }
                         }
+                        } // Paper end - Elyta Wall Damage if statement
 
                         if (this.onGround
                                 && !this.world.isRemote
-- 
2.14.2

